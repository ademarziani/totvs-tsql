DROP VIEW [dbo].[V_CTB_ASIENTOS_01]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[V_CTB_ASIENTOS_01]
AS

SELECT CT2_FILIAL
	,CT2_DATA
	,CT2_LOTE
	,CT2_SBLOTE
	,CT2_DOC
	,CT2_LINHA
	,CT2_MOEDLC
	,'D' AS CT2_DC
	,CT2_DEBITO AS CUENTA
	,CT2_VALOR
	,CT2_HP
	,CT2_HIST
	,CT2_CCD AS CCOSTO
	,CT2_ITEMD AS ITEMCON
	,CT2_CLVLDB AS CLASEVL
	,CT2_TPSALD
	,CT2_SEQUEN
	,CT2_MANUAL
	,CT2_ORIGEM
	,CT2_ROTINA
	,CT2_AGLUT
	,CT2_LP
	,CT2_KEY
	,CT2_USERGI
	,CT2_USERGA
	,CT2_XUSINC
	,CT2_XLOJA
	,CT2_XNUM
	,CT2_XSERIE
	,CT2_XESPEC
	,CT2_XMOD
	,CT2_XTABLA
	,CT2_XORDPA
	,CT2_XRECOB
	,CT2_XTPSLD
	,CT2_XREVAU
	,CT2_XREVER
	,CT2_MOEORI
	,R_E_C_N_O_ AS RECCT2
FROM CT2010
WHERE CT2_DC IN ('1','3')
--AND CT2_TPSALD = '1'
AND D_E_L_E_T_ <> '*'

UNION ALL

SELECT CT2_FILIAL
	,CT2_DATA
	,CT2_LOTE
	,CT2_SBLOTE
	,CT2_DOC
	,CT2_LINHA
	,CT2_MOEDLC
	,'C' AS CT2_DC
	,CT2_CREDIT AS CUENTA
	,CT2_VALOR*-1
	,CT2_HP
	,CT2_HIST
	,CT2_CCC AS CCOSTO
	,CT2_ITEMC AS ITEMCON
	,CT2_CLVLCR AS CLASEVL
	,CT2_TPSALD
	,CT2_SEQUEN
	,CT2_MANUAL
	,CT2_ORIGEM
	,CT2_ROTINA
	,CT2_AGLUT
	,CT2_LP
	,CT2_KEY
	,CT2_USERGI
	,CT2_USERGA
	,CT2_XUSINC
	,CT2_XLOJA
	,CT2_XNUM
	,CT2_XSERIE
	,CT2_XESPEC
	,CT2_XMOD
	,CT2_XTABLA
	,CT2_XORDPA
	,CT2_XRECOB
	,CT2_XTPSLD
	,CT2_XREVAU
	,CT2_XREVER
	,CT2_MOEORI
	,R_E_C_N_O_ AS RECCT2
FROM CT2010
WHERE CT2_DC IN ('2','3')
--AND CT2_TPSALD = '1'
AND D_E_L_E_T_ <> '*'
GO

